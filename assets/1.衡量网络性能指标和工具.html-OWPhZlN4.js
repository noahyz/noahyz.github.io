import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as n,o as l}from"./app-D1zlwylF.js";const h={};function k(t,s){return l(),a("div",null,s[0]||(s[0]=[n(`<h2 id="一、网络的性能指标" tabindex="-1"><a class="header-anchor" href="#一、网络的性能指标"><span>一、网络的性能指标</span></a></h2><ul><li>带宽：表示链路的最大传输速率，单位通常为 b/s（比特/秒）</li><li>吞吐量：表示单位时间内成功传输的数据量，单位通常为 b/s（比特/秒）或者 B/s（字节/秒）。吞吐量受带宽限制，而吞吐量/带宽，就是该网络的使用率</li><li>延时：表示从网络请求发出后，一直到收到远端响应，所需要的时间延迟。在不同场景中，这一指标可能会有不同含义。比如，他可以表示，建立连接需要的时间（比如 TCP 握手延时），或一个数据包往返所需的时间（比如 RTT）</li><li>PPS：（Packet Per Second（包/秒）），表示以网络包为单位的传输速率。PPS 通常用来评估网络的转发能力，比如硬件交换机，通常可以达到线性转发（即 PPS 可以达到或者接近理论最大值）。而基于 Linux 服务器的转发，则容易受网络包大小的影响</li></ul><p>除了这些指标，网络的可用性（网络能否正常通信）、并发连接数（TCP 连接数量）、丢包率（丢包百分比）、重传率（重新传输的网络包比例）等也是常用的性能指标</p><h2 id="二、查看网络信息" tabindex="-1"><a class="header-anchor" href="#二、查看网络信息"><span>二、查看网络信息</span></a></h2><h3 id="_1-查看网络配置" tabindex="-1"><a class="header-anchor" href="#_1-查看网络配置"><span>1. 查看网络配置</span></a></h3><p>ifconfig 和 ip 分别属于软件包 net-tools 和 iproute2，iproute2 是 net-tools 的下一代。查看网络接口 eth1</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [/root] ifconfig eth1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">eth1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> flags=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">4163</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">UP,BROADCAST,RUNNING,MULTICAS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  mtu</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1500</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        inet</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.134.239.95</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  netmask</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 255.255.248.0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  broadcast</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.134.239.255</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        ether</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 52:54:00:d2:e6:38</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  txqueuelen</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  (Ethernet)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        RX</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> packets</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2747150293</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  bytes</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 263319743292</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (245.2 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">GiB</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        RX</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> errors</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  dropped</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  overruns</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  frame</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        TX</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> packets</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 14095335974</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  bytes</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 19311936023826</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (17.5 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">TiB</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        TX</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> errors</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  dropped</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> overruns</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  carrier</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  collisions</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [/root] ip -s addr show dev eth1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> eth1:</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mtu</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1500</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> qdisc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mq</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> state</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> UP</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> group</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> default</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> qlen</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    link/ether</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 52:54:00:d2:e6:38</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> brd</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    inet</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 9.134.239.95/21</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> brd</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.134.239.255</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> scope</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> global</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> eth1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">       valid_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> forever</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> preferred_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> forever</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    RX:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  packets</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  errors</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  dropped</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> overrun</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mcast</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    263320219499</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2747156071</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">       </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    TX:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  packets</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  errors</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  dropped</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> carrier</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> collsns</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    19311984474690</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 14095370649</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>网络接口的状态标志。ifconfig 输出中的 RUNNING ，或 ip 输出中的 LOWER_UP ，都表示物理网络是连通的，即网卡已经连接到了交换机或者路由器中。如果你看不到它们，通常表示网线被拔掉了</li><li>MTU 的大小。MTU 默认大小是 1500，根据网络架构的不同（比如是否使用了 VXLAN 等叠加网络），你可能需要调大或者调小 MTU 的数值</li><li>网络接口的 IP 地址、子网以及 MAC 地址。这些都是保障网络功能正常工作所必需的，需要确保配置正确</li><li>网络收发的字节数、包数、错误数以及丢包情况，特别是 TX 和 RX 部分的 errors、dropped、overruns、carrier 以及 collisions 等指标不为 0 时，通常表示出现了网络 I/O 问题。其中 <ul><li>errors 表示发生错误的数据包数，比如校验错误、帧同步错误等</li><li>dropped 表示丢弃的数据包数，即数据包已经收到了 Ring Buffer，但因为内存不足等原因丢包</li><li>overruns 表示超限数据包数，即网络 IO 速度过快，导致的 Ring Buffer 中的数据包来不及处理（队列满）而导致的丢包</li><li>carrier 表示发生 carrier 错误的数据包数，比如双工模式不匹配、物理电缆出现问题等</li><li>collisions 表示碰撞数据包数</li></ul></li></ul><h3 id="_2-查看套接字信息" tabindex="-1"><a class="header-anchor" href="#_2-查看套接字信息"><span>2. 查看套接字信息</span></a></h3><p>使用 ss 来查询网络的连接信息，因为它比 netstat 提供了更好的性能（速度更快）</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># -l 只显示监听套接字 -n 显示数字地址和端口 -p 显示进程信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [/root] netstat -nlp </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> head</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Active</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Internet</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> connections</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (only </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">servers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Proto</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Recv-Q</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Send-Q</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Local</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Address</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           Foreign</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Address</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         State</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       PID/Program</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0.0.0.0:36000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           0.0.0.0:</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">               LISTEN</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      1005/sshd</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># -l 只显示监听套接字 -t 只显示 TCP 套接字 -n 显示数字地址和端口 -p 显示进程信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [/root] ss -ltnp </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> head</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">State</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      Recv-Q</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Send-Q</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Local</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Address:Port</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">               Peer</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Address:Port</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">              </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">LISTEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      128</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">          *</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:36000</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">                    *</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   users:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">&quot;sshd&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">,pid</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">=1005,fd=3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">LISTEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      128</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    127.0.0.1:57068</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">                    *</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   users:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">&quot;node&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">,pid</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">=21011,fd=19</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接收队列（Recv-Q）和发送队列（Send-Q）通常应该是 0。当不是 0 时，说明网络包有堆积。在不同套接字状态下，他们的含义不同：<br> 当套接字出于连接状态（Established）时：</p><ul><li>Recv-Q 表示套接字缓冲还没有被应用程序取走的字节数（即接收队列长度）</li><li>Send-Q 表示还没有被远端主机确认的字节数（即发送队列长度）</li></ul><p>当套接字出于监听（Listening）时：</p><ul><li>Recv-Q 表示全连接队列的长度</li><li>Send-Q 表示全连接队列的最大长度</li></ul><p>全连接：是指服务器收到了客户端的 ACK，完成了 TCP 三次握手，然后就会把这个连接挪到全连接队列中。这些全连接队列中的套接字，还需要被 accept() 系统调用取走，服务器才可以开始真正处理客户端的请求。</p><p>半连接队列：是指还没有完成 TCP 三次握手的连接，连接只进行了一半。服务器收到客户端的 SYN 包后，就会把这个连接放到半连接队列中，然后再向客户端发送 SYN+ACK 包</p><h3 id="_3-查看网络吞吐和-pps" tabindex="-1"><a class="header-anchor" href="#_3-查看网络吞吐和-pps"><span>3. 查看网络吞吐和 PPS</span></a></h3><p>使用 sar 增加 -n 参数就可以查看网络的统计信息，比如网络接口（DEV）、网络接口错误（EDEV）、TCP、UDP、ICMP 等等</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 数字 1 表示每隔一秒输出一组数据</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [/root] sar -n DEV 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 3.10.107-1-tlinux2_kvm_guest-0054</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (9-134-239-95)  06/05/2022      _x86_64_        (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> CPU</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">07:46:43</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     IFACE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   rxpck/s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   txpck/s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    rxkB/s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    txkB/s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   rxcmp/s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   txcmp/s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  rxmcst/s</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   %ifutil</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">07:46:44</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> br-339aed557726</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">07:46:44</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   docker0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">07:46:44</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      eth1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    243.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   1084.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     21.04</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   1418.80</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">07:46:44</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        lo</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">07:46:44</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> br-374a7621fc52</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">07:46:44</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> br-1e80adb52cbe</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0.00</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>rxpck/s 和 txpck/s 分别是接收和发送的 PPS，单位为包/秒</p></li><li><p>rxkB/s 和 txkB/s 分别是接收和发送的吞吐量，单位是 KB/秒</p></li><li><p>rxcmp/s 和 txcmp/s 分别是接收和发送的压缩数据包数，单位是包/秒</p></li><li><p>%ifutil 是网络接口的使用率。即半双工模式下为 (rxkB/s+txkB/s)/Bandwidth，而全双工模式下为 max(rxkB/s, txkB/s)/Bandwidth<br> Bandwidth 就是带宽，可以用 ethtool 查询，单位通常是 Gb/s 或者 Mb/s，这里的 b 是比特。我们常说的千兆网卡、万兆网卡单位也都是比特。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ethtool eth1 | grep Speed</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h3 id="_4-连通性和延时" tabindex="-1"><a class="header-anchor" href="#_4-连通性和延时"><span>4. 连通性和延时</span></a></h3><p>使用 ping 来测试主机的连通性和延时，基于 ICMP 协议。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>➜  [/root] ping -c3 9.135.14.255</span></span>
<span class="line"><span>PING 9.135.14.255 (9.135.14.255) 56(84) bytes of data.</span></span>
<span class="line"><span>64 bytes from 9.135.14.255: icmp_seq=1 ttl=64 time=0.647 ms</span></span>
<span class="line"><span>64 bytes from 9.135.14.255: icmp_seq=2 ttl=64 time=0.548 ms</span></span>
<span class="line"><span>64 bytes from 9.135.14.255: icmp_seq=3 ttl=64 time=0.626 ms</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--- 9.135.14.255 ping statistics ---</span></span>
<span class="line"><span>3 packets transmitted, 3 received, 0% packet loss, time 1998ms</span></span>
<span class="line"><span>rtt min/avg/max/mdev = 0.548/0.607/0.647/0.042 ms</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>第一部分，是每个 ICMP 请求的信息，包括 ICMP 序列号（icmp_seq）、TTL（生存时间，或者跳数）以及往返延时</li><li>第二部分，则是三次 ICMP 请求的汇总</li></ul>`,25)]))}const r=i(h,[["render",k],["__file","1.衡量网络性能指标和工具.html.vue"]]),d=JSON.parse('{"path":"/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E5%B7%A5%E5%85%B7%E8%BF%90%E7%BB%B4/1.%E8%A1%A1%E9%87%8F%E7%BD%91%E7%BB%9C%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%E5%92%8C%E5%B7%A5%E5%85%B7.html","title":"1.衡量网络性能指标和工具","lang":"zh-CN","frontmatter":{"title":"1.衡量网络性能指标和工具","date":"2023-01-19T11:11:41.000Z","tags":["linux"],"description":"一、网络的性能指标 带宽：表示链路的最大传输速率，单位通常为 b/s（比特/秒） 吞吐量：表示单位时间内成功传输的数据量，单位通常为 b/s（比特/秒）或者 B/s（字节/秒）。吞吐量受带宽限制，而吞吐量/带宽，就是该网络的使用率 延时：表示从网络请求发出后，一直到收到远端响应，所需要的时间延迟。在不同场景中，这一指标可能会有不同含义。比如，他可以表示...","head":[["meta",{"property":"og:url","content":"https://noahyz.github.io/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E5%B7%A5%E5%85%B7%E8%BF%90%E7%BB%B4/1.%E8%A1%A1%E9%87%8F%E7%BD%91%E7%BB%9C%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%E5%92%8C%E5%B7%A5%E5%85%B7.html"}],["meta",{"property":"og:site_name","content":"noahyz的博客"}],["meta",{"property":"og:title","content":"1.衡量网络性能指标和工具"}],["meta",{"property":"og:description","content":"一、网络的性能指标 带宽：表示链路的最大传输速率，单位通常为 b/s（比特/秒） 吞吐量：表示单位时间内成功传输的数据量，单位通常为 b/s（比特/秒）或者 B/s（字节/秒）。吞吐量受带宽限制，而吞吐量/带宽，就是该网络的使用率 延时：表示从网络请求发出后，一直到收到远端响应，所需要的时间延迟。在不同场景中，这一指标可能会有不同含义。比如，他可以表示..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"noahyz"}],["meta",{"property":"article:tag","content":"linux"}],["meta",{"property":"article:published_time","content":"2023-01-19T11:11:41.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"1.衡量网络性能指标和工具\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-01-19T11:11:41.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"noahyz\\",\\"url\\":\\"/about-the-author/\\"}]}"]]},"headers":[{"level":2,"title":"一、网络的性能指标","slug":"一、网络的性能指标","link":"#一、网络的性能指标","children":[]},{"level":2,"title":"二、查看网络信息","slug":"二、查看网络信息","link":"#二、查看网络信息","children":[{"level":3,"title":"1. 查看网络配置","slug":"_1-查看网络配置","link":"#_1-查看网络配置","children":[]},{"level":3,"title":"2. 查看套接字信息","slug":"_2-查看套接字信息","link":"#_2-查看套接字信息","children":[]},{"level":3,"title":"3. 查看网络吞吐和 PPS","slug":"_3-查看网络吞吐和-pps","link":"#_3-查看网络吞吐和-pps","children":[]},{"level":3,"title":"4. 连通性和延时","slug":"_4-连通性和延时","link":"#_4-连通性和延时","children":[]}]}],"git":{},"readingTime":{"minutes":6.03,"words":1809},"filePathRelative":"计算机网络/工具运维/1.衡量网络性能指标和工具.md","localizedDate":"2023年1月19日","excerpt":"<h2>一、网络的性能指标</h2>\\n<ul>\\n<li>带宽：表示链路的最大传输速率，单位通常为 b/s（比特/秒）</li>\\n<li>吞吐量：表示单位时间内成功传输的数据量，单位通常为 b/s（比特/秒）或者 B/s（字节/秒）。吞吐量受带宽限制，而吞吐量/带宽，就是该网络的使用率</li>\\n<li>延时：表示从网络请求发出后，一直到收到远端响应，所需要的时间延迟。在不同场景中，这一指标可能会有不同含义。比如，他可以表示，建立连接需要的时间（比如 TCP 握手延时），或一个数据包往返所需的时间（比如 RTT）</li>\\n<li>PPS：（Packet Per Second（包/秒）），表示以网络包为单位的传输速率。PPS 通常用来评估网络的转发能力，比如硬件交换机，通常可以达到线性转发（即 PPS 可以达到或者接近理论最大值）。而基于 Linux 服务器的转发，则容易受网络包大小的影响</li>\\n</ul>","autoDesc":true}');export{r as comp,d as data};

import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as l,a,o as i}from"./app-D1zlwylF.js";const s="/assets/%E5%86%85%E5%AD%98%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87-CxX5cCGe.jpg",n="/assets/%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%E5%B7%A5%E5%85%B7-CSAdIVCr.jpg",r="/assets/%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%E5%B7%A5%E5%85%B72-BPVtHb-D.jpg",o="/assets/%E5%86%85%E5%AD%98%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B-Vdv9JYJh.jpg",p={};function E(h,t){return i(),l("div",null,t[0]||(t[0]=[a('<h2 id="如何快速定位系统内存问题" tabindex="-1"><a class="header-anchor" href="#如何快速定位系统内存问题"><span>如何快速定位系统内存问题</span></a></h2><h3 id="一、内存性能指标" tabindex="-1"><a class="header-anchor" href="#一、内存性能指标"><span>一、内存性能指标</span></a></h3><h4 id="_1-系统内存使用情况" tabindex="-1"><a class="header-anchor" href="#_1-系统内存使用情况"><span>1. 系统内存使用情况</span></a></h4><ul><li>已用内存和剩余内存，就是已经使用和还未使用的内存。</li><li>共享内存是通过 tmpfs 实现的，所以它的大小也就是 tmpfs 使用的内存大小。tmpfs 其实也是一种特殊的缓存。</li><li>可用内存是新进程可以使用的最大内存，它包括剩余内存和可回收缓存。</li><li>缓存包括两部分，一部分是磁盘读取文件的页缓存，用来缓存从磁盘读取的数据，可以加快以后再次访问的速度。另一部分，则是 Slab 分配器中的可回收内存</li><li>缓冲区是对原始磁盘块的临时存储，用来缓存将要写入磁盘的数据。这样，内核就可以把分散的写集中起来，统一优化磁盘写入。</li></ul><h4 id="_2-进程内存使用情况" tabindex="-1"><a class="header-anchor" href="#_2-进程内存使用情况"><span>2. 进程内存使用情况</span></a></h4><ul><li>虚拟内存，包括了进程代码段、数据段、共享内存、已经申请的堆内存和已经换出的内存等。这里要注意，已经申请的内存，即使还没有分配物理内存，也算作虚拟内存。</li><li>常驻内存是进程实际使用的物理内存，不过，它不包括 Swap 和共享内存。</li><li>共享内存，既包括与其他进程共同使用的真实的共享内存，还包括了加载的动态链接库以及程序的代码段等。</li><li>Swap 内存，是指通过 Swap 换出到磁盘的内存。</li></ul><p>系统调用内存分配请求后，并会立刻为其分配物理内存，而是在请求首次访问时，通过缺页异常来分配。缺页异常分为如下两个场景：</p><ul><li>可以直接从物理内存中分配时，被称为次缺页异常</li><li>需要磁盘 IO 介入（比如 Swap）时，被称为主缺页异常。主缺页异常，意味着需要磁盘IO，那么内存访问就会慢很多</li></ul><h4 id="_3-swap-的使用情况" tabindex="-1"><a class="header-anchor" href="#_3-swap-的使用情况"><span>3. Swap 的使用情况</span></a></h4><ul><li>Swap 的已用空间和剩余空间，也就是已经使用和没有使用的内存空间</li><li>换入和换出速度，则表示每秒钟换入和换出内存的大小</li></ul><img src="'+s+'" style="zoom:50%;"><h3 id="二、内存性能工具" tabindex="-1"><a class="header-anchor" href="#二、内存性能工具"><span>二、内存性能工具</span></a></h3><ul><li>free、top、ps</li><li>通过 proc 文件系统，内存指标的来源，通过 vmstat 可动态观察内存的变化情况。</li><li>cachestat 查看整个系统缓存的读写命中情况，使用 cachetop 观察每个进程缓存的读写命中情况</li><li>memleak 查看内存泄露</li><li>sar</li></ul><img src="'+n+'" style="zoom:50%;"><img src="'+r+'" style="zoom:50%;"><h3 id="三、如何快速分析内存的性能瓶颈" tabindex="-1"><a class="header-anchor" href="#三、如何快速分析内存的性能瓶颈"><span>三、如何快速分析内存的性能瓶颈</span></a></h3><ol><li>先用 free 和 top，查看系统整体的内存使用情况。</li><li>再用 vmstat 和 pidstat，查看一段时间的趋势，从而判断出内存问题的类型。</li><li>最后进行详细分析，比如内存分配分析、缓存 / 缓冲区分析、具体进程的内存使用分析等。</li></ol><img src="'+o+'" style="zoom:67%;">',18)]))}const d=e(p,[["render",E],["__file","2.如何定位系统内存问题.html.vue"]]),B=JSON.parse('{"path":"/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/%E5%B7%A5%E5%85%B7%E8%BF%90%E7%BB%B4/2.%E5%A6%82%E4%BD%95%E5%AE%9A%E4%BD%8D%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E9%97%AE%E9%A2%98.html","title":"2.如何定位系统内存问题","lang":"zh-CN","frontmatter":{"title":"2.如何定位系统内存问题","date":"2023-01-19T11:11:41.000Z","tags":["linux"],"description":"如何快速定位系统内存问题 一、内存性能指标 1. 系统内存使用情况 已用内存和剩余内存，就是已经使用和还未使用的内存。 共享内存是通过 tmpfs 实现的，所以它的大小也就是 tmpfs 使用的内存大小。tmpfs 其实也是一种特殊的缓存。 可用内存是新进程可以使用的最大内存，它包括剩余内存和可回收缓存。 缓存包括两部分，一部分是磁盘读取文件的页缓存，...","head":[["meta",{"property":"og:url","content":"https://noahyz.github.io/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/%E5%B7%A5%E5%85%B7%E8%BF%90%E7%BB%B4/2.%E5%A6%82%E4%BD%95%E5%AE%9A%E4%BD%8D%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E9%97%AE%E9%A2%98.html"}],["meta",{"property":"og:site_name","content":"noahyz的博客"}],["meta",{"property":"og:title","content":"2.如何定位系统内存问题"}],["meta",{"property":"og:description","content":"如何快速定位系统内存问题 一、内存性能指标 1. 系统内存使用情况 已用内存和剩余内存，就是已经使用和还未使用的内存。 共享内存是通过 tmpfs 实现的，所以它的大小也就是 tmpfs 使用的内存大小。tmpfs 其实也是一种特殊的缓存。 可用内存是新进程可以使用的最大内存，它包括剩余内存和可回收缓存。 缓存包括两部分，一部分是磁盘读取文件的页缓存，..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"noahyz"}],["meta",{"property":"article:tag","content":"linux"}],["meta",{"property":"article:published_time","content":"2023-01-19T11:11:41.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"2.如何定位系统内存问题\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-01-19T11:11:41.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"noahyz\\",\\"url\\":\\"/about-the-author/\\"}]}"]]},"headers":[{"level":2,"title":"如何快速定位系统内存问题","slug":"如何快速定位系统内存问题","link":"#如何快速定位系统内存问题","children":[{"level":3,"title":"一、内存性能指标","slug":"一、内存性能指标","link":"#一、内存性能指标","children":[]},{"level":3,"title":"二、内存性能工具","slug":"二、内存性能工具","link":"#二、内存性能工具","children":[]},{"level":3,"title":"三、如何快速分析内存的性能瓶颈","slug":"三、如何快速分析内存的性能瓶颈","link":"#三、如何快速分析内存的性能瓶颈","children":[]}]}],"git":{},"readingTime":{"minutes":2.77,"words":831},"filePathRelative":"操作系统/内存管理/工具运维/2.如何定位系统内存问题.md","localizedDate":"2023年1月19日","excerpt":"<h2>如何快速定位系统内存问题</h2>\\n<h3>一、内存性能指标</h3>\\n<h4>1. 系统内存使用情况</h4>\\n<ul>\\n<li>已用内存和剩余内存，就是已经使用和还未使用的内存。</li>\\n<li>共享内存是通过 tmpfs 实现的，所以它的大小也就是 tmpfs 使用的内存大小。tmpfs 其实也是一种特殊的缓存。</li>\\n<li>可用内存是新进程可以使用的最大内存，它包括剩余内存和可回收缓存。</li>\\n<li>缓存包括两部分，一部分是磁盘读取文件的页缓存，用来缓存从磁盘读取的数据，可以加快以后再次访问的速度。另一部分，则是 Slab 分配器中的可回收内存</li>\\n<li>缓冲区是对原始磁盘块的临时存储，用来缓存将要写入磁盘的数据。这样，内核就可以把分散的写集中起来，统一优化磁盘写入。</li>\\n</ul>","autoDesc":true}');export{d as comp,B as data};

import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as l,a as i,o as A}from"./app-D1zlwylF.js";const o={};function n(r,t){return A(),l("div",null,t[0]||(t[0]=[i("<p>硬盘上有两个 ATA 通道，也称为 IDE 通道。</p><ul><li>第一个 ATA 通道上的两个硬盘（主盘和从盘）的中断信号挂在 8259A 从盘的 IRQ14 上。两个硬盘共享同一个 IRQ 接口。</li><li>第二个 ATA 通道接在 8259A 从片的 IRQ15 上，该 ATA 通道上可支持两个硬盘。</li></ul><p>硬件发生中断时，如何区分中断来自那个硬盘？</p><ul><li>我们对硬盘发命令时，需要提前指定主盘还是从盘。这是在硬盘控制器的 device 寄存器中第 4 位的 dev 位指定的。因此也就知道是哪个硬盘来了中断信号。</li><li>但在硬盘完成操作后，它还得通知调用者任务执行的结果，是顺利完成，还是失败，如果是读硬盘的话，现在可以取数据了，这里是让硬盘主动发中断来通知调用者的。但一个通道只能有一个中断，却有两个硬盘。因此一次只允许通道中的一个硬盘操作。因此在通道中设置锁来实现互斥，对通道中的任何一个硬盘操作时都要申请该锁来实现独享通道。</li></ul><hr><p>中断处理完成后，需要显示通知硬盘控制器此次中断已经处理完成，否则硬盘便不会产生新的中断，这也是为了保证数据的有效性和安全性。硬盘控制器的中断在下列情况下会被清掉：</p><ul><li>读取了 status 寄存器</li><li>发出了 reset 命令</li><li>或者又向硬盘 cmd 寄存器写入了新的命令</li></ul><hr><p>linux 中对于硬盘的命令规则是：<code>[x]d[y][n]</code>，其中只有字母 d 是固定的，其他带中括号的字符都是多选值</p><ul><li><code>x</code> 表示硬盘分类，硬盘有两大类，IDE 磁盘和 SCSI 磁盘。h 代表 IDE 磁盘，s 代表 SCSI 磁盘，故 x 取值为 h 和 s</li><li>d 表示 disk，表示磁盘</li><li>y 表示设备号，以区分第几个设备，取值范围是小写字符，其中 a 是第一个硬盘，b 是第二个硬盘，依次类推</li><li>n 表示分区号，也就是一个硬盘上的第几个分区。分区以数字 1 开始，依次类推</li></ul><p>比如，<code>sda1</code> 表示第一个 SCSI 硬盘的第一个分区</p>",11)]))}const E=e(o,[["render",n],["__file","4.硬盘驱动程序.html.vue"]]),c=JSON.parse('{"path":"/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E6%89%8B%E5%86%99%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/6.%E7%A1%AC%E7%9B%98/4.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F.html","title":"硬盘驱动程序","lang":"zh-CN","frontmatter":{"title":"硬盘驱动程序","description":"硬盘上有两个 ATA 通道，也称为 IDE 通道。 第一个 ATA 通道上的两个硬盘（主盘和从盘）的中断信号挂在 8259A 从盘的 IRQ14 上。两个硬盘共享同一个 IRQ 接口。 第二个 ATA 通道接在 8259A 从片的 IRQ15 上，该 ATA 通道上可支持两个硬盘。 硬件发生中断时，如何区分中断来自那个硬盘？ 我们对硬盘发命令时，需要提...","head":[["meta",{"property":"og:url","content":"https://noahyz.github.io/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E6%89%8B%E5%86%99%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/6.%E7%A1%AC%E7%9B%98/4.%E7%A1%AC%E7%9B%98%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F.html"}],["meta",{"property":"og:site_name","content":"noahyz的博客"}],["meta",{"property":"og:title","content":"硬盘驱动程序"}],["meta",{"property":"og:description","content":"硬盘上有两个 ATA 通道，也称为 IDE 通道。 第一个 ATA 通道上的两个硬盘（主盘和从盘）的中断信号挂在 8259A 从盘的 IRQ14 上。两个硬盘共享同一个 IRQ 接口。 第二个 ATA 通道接在 8259A 从片的 IRQ15 上，该 ATA 通道上可支持两个硬盘。 硬件发生中断时，如何区分中断来自那个硬盘？ 我们对硬盘发命令时，需要提..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"noahyz"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"硬盘驱动程序\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"noahyz\\",\\"url\\":\\"/about-the-author/\\"}]}"]]},"headers":[],"git":{},"readingTime":{"minutes":2,"words":600},"filePathRelative":"技术专题/手写操作系统/6.硬盘/4.硬盘驱动程序.md","excerpt":"<p>硬盘上有两个 ATA 通道，也称为 IDE 通道。</p>\\n<ul>\\n<li>第一个 ATA 通道上的两个硬盘（主盘和从盘）的中断信号挂在 8259A 从盘的 IRQ14 上。两个硬盘共享同一个 IRQ 接口。</li>\\n<li>第二个 ATA 通道接在 8259A 从片的 IRQ15 上，该 ATA 通道上可支持两个硬盘。</li>\\n</ul>\\n<p>硬件发生中断时，如何区分中断来自那个硬盘？</p>\\n<ul>\\n<li>我们对硬盘发命令时，需要提前指定主盘还是从盘。这是在硬盘控制器的 device 寄存器中第 4 位的 dev 位指定的。因此也就知道是哪个硬盘来了中断信号。</li>\\n<li>但在硬盘完成操作后，它还得通知调用者任务执行的结果，是顺利完成，还是失败，如果是读硬盘的话，现在可以取数据了，这里是让硬盘主动发中断来通知调用者的。但一个通道只能有一个中断，却有两个硬盘。因此一次只允许通道中的一个硬盘操作。因此在通道中设置锁来实现互斥，对通道中的任何一个硬盘操作时都要申请该锁来实现独享通道。</li>\\n</ul>","autoDesc":true}');export{E as comp,c as data};

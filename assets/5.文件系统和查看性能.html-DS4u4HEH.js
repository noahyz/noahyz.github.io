import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as h,o as n}from"./app-D1zlwylF.js";const k="/assets/%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA-DL2ZPJXn.jpg",l="/assets/%E6%9F%B1%E9%9D%A2%E7%BB%84-B_7J-wPE.jpg",t="/assets/%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95-B90Jpd00.jpg",p="/assets/%E8%99%9A%E6%8B%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-DVxSFaXe.png",e={};function d(r,i){return n(),a("div",null,i[0]||(i[0]=[h('<h2 id="文件系统" tabindex="-1"><a class="header-anchor" href="#文件系统"><span>文件系统</span></a></h2><h3 id="一、文件系统" tabindex="-1"><a class="header-anchor" href="#一、文件系统"><span>一、文件系统</span></a></h3><p>Linux 中一切皆文件，普通的文件、目录、块设备、套接字、管道等都是文件，通过统一的文件系统来管理。Linux 文件系统为每个文件都分配两个数据结构，索引节点（index node）和目录项（directory entry）。他们主要用来记录文件的元信息和目录结构。</p><ul><li>索引节点（inode）。用来记录文件的元数据，比如 inode 编号、文件大小、访问权限、修改日期、数据的位置等。索引节点和文件一一对应，它跟文件内容一样，都会被持久化存储到磁盘中。所以索引节点同样占用磁盘空间</li><li>目录项（dentry）。用来记录文件的名字、索引节点指针以及与其他目录项的关联关系。多个关联的目录项，就构成了文件系统的目录结构。不过，不同于索引节点，目录项是由内核维护的一个内存数据结构，所以通常也被叫做目录项缓存</li></ul><p>索引节点是每个文件的唯一标志，而目录项维护的正是文件系统的树状结构。目录项和索引节点的关系是多对一。通过硬链接为文件创建的别名，会对应不同的目录项，不过这些目录项都有相同的 inode 编号，指向相同的 inode。</p><p>磁盘在执行文件系统格式化时，会被分成四个存储区域：</p><ul><li>自举块、超级块：存储整个文件系统的状态</li><li>索引节点区：用来存储索引节点</li><li>数据块区：用来存储文件数据</li></ul><p>我们把一个磁盘分成一个或多个分区。每个分区可以包含一个文件系统。i 节点是固定长度的记录项，它包含有关文件的大部分信息</p><img src="'+k+'" style="zoom:80%;"><p>如下是一个柱面组的 i 节点和数据块部分</p><figure><img src="'+l+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>硬链接，有两个目录项指向同一个 i 节点。每个 i 节点中都有一个链接计数，其值是指向该 i 节点的目录项数。只有当链接计数减少至 0 时，才可以删除该文件（也就是可以释放该文件占用的数据块）。在 stat 结构中，链接计数包含在 st_nlink 成员中，其基本系统数据类型是 nlink_t，称为硬链接。</li><li>符号链接（软链接）。符号链接文件的实际内容（在数据块中）包含了该符号链接所指向的文件的名字，比如 <code> lib -&gt; /usr/lib</code>，目录项中名为 lib 的文件保存了 7 字节的数据 <code>/usr/lib</code>。且该 i 节点中的文件类型是 S_IFLINK，系统就是知道这是一个符号链接</li><li>i 节点包含了文件有关的所有信息：文件类型、文件访问权限位、文件长度和指向文件数据块的指针等。只有两项重要数据存放在目录项中：文件名和 i 节点编号。</li><li>因为目录项中的 i 节点编号指向同一文件系统中的相应 i 节点，一个目录项不能指向另一个文件系统的 i 节点。</li><li>当在不更新文件系统的情况下为一个文件重命名时，该文件的实际内容并未移动，只需要构造一个指向现有 i 节点的新目录项，并删除老的目录项。链接计数不会改变。</li></ul><h4 id="创建一个目录场景" tabindex="-1"><a class="header-anchor" href="#创建一个目录场景"><span>创建一个目录场景</span></a></h4><p>执行 <code>mkdir testdir</code> 命令之后</p><img src="'+t+'" style="zoom:80%;"><ul><li>编号为 2549 的 i 节点，其类型字段表示他是一个目录，链接计数为 2</li><li>任何一个叶目录（不包含任何其他目录的目录）的链接计数总是 2，数值 2 来自于命名该目录（testdir）的目录项以及在该目录中的 <code>.</code> 项</li><li>编号为 1267 的 i 节点，其类型字段表示他是一个目录，链接计数大于或者等于 3，因为一个是命名它的目录项（未画出来），第二个是该目录中的 <code>.</code> 项，第三个是它的子目录中的 <code>..</code> 项</li><li>在父目录中的每一个字目录都使该父目录的链接计数增加 1</li></ul><h3 id="二、虚拟文件系统" tabindex="-1"><a class="header-anchor" href="#二、虚拟文件系统"><span>二、虚拟文件系统</span></a></h3><p>为了支持各种不同的文件系统，Linux 内核在用户进程和文件系统的中间，引入了抽象层，也就是虚拟文件系统 VFS（Virtual File System）。VFS 定义了一组所有文件系统都支持的数据结构和标准接口。这样，用户进程和内核中的其他子系统，只需要跟 VFS 提供的统一接口进行交互就可以了，而不需要再关心底层各种文件系统的实现细节。</p><img src="'+p+`" alt="s" style="zoom:80%;"><p>在 VFS 的下方，Linux 支持各种各样的文件系统。如 Ext4、XFS、NFS 等等。按照存储位置的不同，这些文件系统可以分为三类</p><ul><li>第一类是基于磁盘的文件系统，也就是把数据直接存储在计算机本地挂载的磁盘中。常见的 Ext4、XFS、OverlayFS 等，都是这类文件系统。</li><li>第二类是基于内存的文件系统，也就是我们常说的虚拟文件系统。这类文件系统，不需要任何磁盘分配存储空间，但会占用内存。我们经常用到的 /proc 文件系统，其实就是一种最常见的虚拟文件系统。此外，/sys 文件系统也属于这一类，主要向用户空间导出层次化的内核对象</li><li>第三类是网络文件系统，也就是用来访问其他计算机数据的文件系统，比如 NFS、SMB、iSCSI 等。</li></ul><p>这些文件系统，要先挂载到 VFS 目录树中的某个子目录（称为挂载点），然后才能访问其中的文件。拿第一类，也就是基于磁盘的文件系统为例，在安装系统时，要先挂载一个根目录（/），在根目录下再把其他文件系统（比如其他的磁盘分区、/proc 文件系统、/sys 文件系统、NFS 等）挂载进来。</p><h3 id="三、观察文件系统性能" tabindex="-1"><a class="header-anchor" href="#三、观察文件系统性能"><span>三、观察文件系统性能</span></a></h3><h4 id="_1-容量" tabindex="-1"><a class="header-anchor" href="#_1-容量"><span>1. 容量</span></a></h4><ul><li>查看文件系统的磁盘空间使用情况</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [/usr/local/bin] df -h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Used</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Avail</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Use%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/dev/vda1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        99G</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   81G</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   14G</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  86%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">devtmpfs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        7.7G</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  7.7G</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   0%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">           7.7G</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  7.7G</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   0%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev/shm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>索引节点也占用磁盘空间，查看索引节点的使用情况</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [/usr/local/bin] df -i</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       Inodes</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   IUsed</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    IFree</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> IUse%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/dev/vda1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       6553600</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1295152</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  5258448</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   20%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">devtmpfs</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">        2009249</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1452</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  2007797</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    1%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           2011523</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       9</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  2011514</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    1%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev/shm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当遇到空间不足时，使用 df 查看磁盘空间后，却发现剩余空间还有很多。这是我们可以查看索引节点的使用情况，索引节点的容量（也就是 inode 个数）是在格式化磁盘时设定好的，一般由格式化工具自动生成。当你发现索引节点空间不足，但磁盘空间充足时，很可能就是过多小文件导致的。</p><h4 id="_2-缓存" tabindex="-1"><a class="header-anchor" href="#_2-缓存"><span>2. 缓存</span></a></h4><p>free 输出的 Cache，是页缓存和可回收 Slab 缓存的和，你可以从 /proc/meminfo ，直接得到它们的大小</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [/usr/local/bin] cat /proc/meminfo </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;SReclaimable|Cached&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Cached:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">          1932632</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kB</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SwapCached:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">            0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kB</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SReclaimable:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     324120</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>内核使用 Slab 机制，管理目录项和索引节点的缓存。<code>/proc/meminfo</code> 只给出了 Slab 的整体大小，具体到每一种 Slab 缓存，还要查看 <code>/proc/slabinfo</code> 这个文件。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  [/usr/local/bin] cat /proc/slabinfo</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;^#|dentry|inode&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># name            &lt;active_objs&gt; &lt;num_objs&gt; &lt;objsize&gt; &lt;objperslab&gt; &lt;pagesperslab&gt; : tunables &lt;limit&gt; &lt;batchcount&gt; &lt;sharedfactor&gt; : slabdata &lt;active_slabs&gt; &lt;num_slabs&gt; &lt;sharedavail&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">rpc_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       25</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     25</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    640</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   25</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mqueue_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    288</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    288</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    896</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   36</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">udf_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    704</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   23</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">isofs_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    608</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   26</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">fat_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    688</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   23</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hugetlbfs_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     28</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     28</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    576</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   28</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">jbd2_inode</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">          7298</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  14110</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     48</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   85</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    166</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    166</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ext4_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  202624</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 202624</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    984</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   33</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   6141</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   6141</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ext2_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    728</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   22</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ext3_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    784</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   20</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">inotify_inode_mark</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   5474</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   5474</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    120</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   34</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    161</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    161</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sock_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1500</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   1500</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    640</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   25</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     60</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">     60</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">shmem_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  23400</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  23400</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    648</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   25</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    936</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    936</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">proc_inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    6618</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   7325</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    640</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   25</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    293</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    293</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">inode_cache</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">        16433</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  16907</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    560</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   29</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    583</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    583</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">dentry</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">            315911</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 316760</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    200</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   20</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tunables</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slabdata</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  15838</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  15838</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>dentry 行表示目录项缓存，inode_cache 行表示 VFS 索引节点缓存，其余的则是各种文件系统的索引节点缓存</li></ul><p>使用 slabtop 找到占用内存最多的缓存类型</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 按下 c 按照缓存大小排序，按下 a 按照活跃对象数排序</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[/usr/local/bin] slabtop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Active</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Objects</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (% </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">used</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)    </span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 1364167 / 1441535 (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">94.6%</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Active</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Slabs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (% </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">used</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)      </span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 42114 / 42114 (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">100.0%</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Active</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Caches</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (% </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">used</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)     </span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 132 / 205 (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">64.4%</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Active</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (% </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">used</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)       </span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 389699.93K / 400512.44K (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">97.3%</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> Minimum</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Average</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Maximum</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Object</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0.01K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0.28K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8.00K</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  OBJS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ACTIVE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  USE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJ</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SIZE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  SLABS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OBJ/SLAB</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> CACHE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SIZE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">                   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">202624</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 202624</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 100%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    0.96K</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   6141</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       33</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    196512K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ext4_inode_cache</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">316940</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 316464</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  99%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    0.20K</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  15847</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       20</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     63388K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> dentry</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">269997</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 266468</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  98%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    0.10K</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   6923</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       39</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     27692K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> buffer_head</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 23400</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  23400</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 100%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    0.63K</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    936</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       25</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     14976K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shmem_inode_cache</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 18088</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  17703</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  97%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    0.55K</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    646</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       28</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     10336K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> radix_tree_node</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 16907</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  16436</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  97%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    0.55K</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    583</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       29</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      9328K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> inode_cache</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  1078</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    970</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  89%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    6.45K</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    283</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">        4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      9056K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> task_struct</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">203286</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 203286</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 100%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    0.04K</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   1993</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      102</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      7972K</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ext4_extent_status</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如上，可以看到，ext4_inode_cache 和 dentry 占用了最多的 Slab 缓存，占用空间 259M （196512K + 63388K）</p><p>比如执行 find 命令时，就会增加 <code>inode cache &amp; dentry &amp; proc inode cache</code> 这些缓存会升高</p>`,39)]))}const y=s(e,[["render",d],["__file","5.文件系统和查看性能.html.vue"]]),F=JSON.parse('{"path":"/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/%E5%86%85%E6%A0%B8%E5%8E%9F%E7%90%86/5.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%92%8C%E6%9F%A5%E7%9C%8B%E6%80%A7%E8%83%BD.html","title":"5.文件系统和查看性能","lang":"zh-CN","frontmatter":{"title":"5.文件系统和查看性能","date":"2023-01-19T11:11:41.000Z","tags":["linux"],"description":"文件系统 一、文件系统 Linux 中一切皆文件，普通的文件、目录、块设备、套接字、管道等都是文件，通过统一的文件系统来管理。Linux 文件系统为每个文件都分配两个数据结构，索引节点（index node）和目录项（directory entry）。他们主要用来记录文件的元信息和目录结构。 索引节点（inode）。用来记录文件的元数据，比如 inod...","head":[["meta",{"property":"og:url","content":"https://noahyz.github.io/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/%E5%86%85%E6%A0%B8%E5%8E%9F%E7%90%86/5.%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%92%8C%E6%9F%A5%E7%9C%8B%E6%80%A7%E8%83%BD.html"}],["meta",{"property":"og:site_name","content":"noahyz的博客"}],["meta",{"property":"og:title","content":"5.文件系统和查看性能"}],["meta",{"property":"og:description","content":"文件系统 一、文件系统 Linux 中一切皆文件，普通的文件、目录、块设备、套接字、管道等都是文件，通过统一的文件系统来管理。Linux 文件系统为每个文件都分配两个数据结构，索引节点（index node）和目录项（directory entry）。他们主要用来记录文件的元信息和目录结构。 索引节点（inode）。用来记录文件的元数据，比如 inod..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"noahyz"}],["meta",{"property":"article:tag","content":"linux"}],["meta",{"property":"article:published_time","content":"2023-01-19T11:11:41.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"5.文件系统和查看性能\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-01-19T11:11:41.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"noahyz\\",\\"url\\":\\"/about-the-author/\\"}]}"]]},"headers":[{"level":2,"title":"文件系统","slug":"文件系统","link":"#文件系统","children":[{"level":3,"title":"一、文件系统","slug":"一、文件系统","link":"#一、文件系统","children":[]},{"level":3,"title":"二、虚拟文件系统","slug":"二、虚拟文件系统","link":"#二、虚拟文件系统","children":[]},{"level":3,"title":"三、观察文件系统性能","slug":"三、观察文件系统性能","link":"#三、观察文件系统性能","children":[]}]}],"git":{},"readingTime":{"minutes":8.18,"words":2453},"filePathRelative":"操作系统/文件管理/内核原理/5.文件系统和查看性能.md","localizedDate":"2023年1月19日","excerpt":"<h2>文件系统</h2>\\n<h3>一、文件系统</h3>\\n<p>Linux 中一切皆文件，普通的文件、目录、块设备、套接字、管道等都是文件，通过统一的文件系统来管理。Linux 文件系统为每个文件都分配两个数据结构，索引节点（index node）和目录项（directory entry）。他们主要用来记录文件的元信息和目录结构。</p>\\n<ul>\\n<li>索引节点（inode）。用来记录文件的元数据，比如 inode 编号、文件大小、访问权限、修改日期、数据的位置等。索引节点和文件一一对应，它跟文件内容一样，都会被持久化存储到磁盘中。所以索引节点同样占用磁盘空间</li>\\n<li>目录项（dentry）。用来记录文件的名字、索引节点指针以及与其他目录项的关联关系。多个关联的目录项，就构成了文件系统的目录结构。不过，不同于索引节点，目录项是由内核维护的一个内存数据结构，所以通常也被叫做目录项缓存</li>\\n</ul>","autoDesc":true}');export{y as comp,F as data};
